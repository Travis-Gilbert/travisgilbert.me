{% extends "base.html" %}

{% block title %}{{ page_title }}{% endblock %}

{% block content %}
{# ------------------------------------------------------------------ #}
{# Header                                                              #}
{# ------------------------------------------------------------------ #}
<section class="mb-6">
    <span class="font-mono text-[11px] tracking-widest uppercase text-teal block mb-1">
        Research Threads
    </span>
    <h1 class="font-title text-3xl font-bold text-ink m-0 mb-2">Threads</h1>
    <p class="font-body text-ink-muted text-sm max-w-xl m-0">
        Each thread traces a line of inquiry: the questions asked, sources found,
        connections made, and milestones reached.
    </p>
</section>

{# ------------------------------------------------------------------ #}
{# Filter tabs                                                         #}
{# ------------------------------------------------------------------ #}
<div class="flex items-center gap-1 mb-6 border-b border-border pb-3">
    <a href="{% url 'paper_trail:threads' %}"
       class="px-3 py-1.5 rounded-brand font-mono text-[11px] tracking-wide no-underline transition-colors duration-150
              {% if not active_filter %}bg-teal/10 text-teal border border-teal/20{% else %}text-ink-muted hover:bg-surface hover:text-ink{% endif %}">
        All
    </a>
    <a href="{% url 'paper_trail:threads' %}?status=active"
       class="px-3 py-1.5 rounded-brand font-mono text-[11px] tracking-wide no-underline transition-colors duration-150
              {% if active_filter == 'active' %}bg-teal/10 text-teal border border-teal/20{% else %}text-ink-muted hover:bg-surface hover:text-ink{% endif %}">
        Active
    </a>
    <a href="{% url 'paper_trail:threads' %}?status=completed"
       class="px-3 py-1.5 rounded-brand font-mono text-[11px] tracking-wide no-underline transition-colors duration-150
              {% if active_filter == 'completed' %}bg-teal/10 text-teal border border-teal/20{% else %}text-ink-muted hover:bg-surface hover:text-ink{% endif %}">
        Completed
    </a>
    <a href="{% url 'paper_trail:threads' %}?status=paused"
       class="px-3 py-1.5 rounded-brand font-mono text-[11px] tracking-wide no-underline transition-colors duration-150
              {% if active_filter == 'paused' %}bg-teal/10 text-teal border border-teal/20{% else %}text-ink-muted hover:bg-surface hover:text-ink{% endif %}">
        Paused
    </a>
</div>

{# ------------------------------------------------------------------ #}
{# Thread cards                                                        #}
{# ------------------------------------------------------------------ #}
<div class="grid grid-cols-1 md:grid-cols-2 gap-4">
    {% for thread in threads %}
    <a href="{% url 'paper_trail:thread-detail' slug=thread.slug %}"
       class="bg-surface border border-border rounded-brand p-5 no-underline hover:border-teal/30 transition-colors group">
        <div class="flex items-center gap-2 mb-2">
            <h2 class="font-title text-lg font-bold text-ink m-0 group-hover:text-teal transition-colors">
                {{ thread.title }}
            </h2>
            <span class="font-mono text-[9px] tracking-widest uppercase px-1.5 py-0.5 rounded flex-shrink-0
                {% if thread.status == 'active' %}bg-teal/10 text-teal border border-teal/20
                {% elif thread.status == 'completed' %}bg-success/10 text-success border border-success/20
                {% elif thread.status == 'paused' %}bg-gold/10 text-gold border border-gold/20
                {% else %}bg-bg-alt text-ink-muted border border-border
                {% endif %}
            ">
                {{ thread.get_status_display }}
            </span>
        </div>

        {% if thread.description %}
        <p class="font-body text-sm text-ink-muted m-0 mb-3 line-clamp-2">{{ thread.description }}</p>
        {% endif %}

        <div class="flex items-center gap-4">
            <span class="font-mono text-[10px] tracking-wide text-ink-light">
                {{ thread.entry_count }} entr{{ thread.entry_count|pluralize:"y,ies" }}
            </span>
            {% if thread.started_date %}
            <span class="font-mono text-[10px] tracking-wide text-ink-light">
                Started {{ thread.started_date|date:"M j, Y" }}
            </span>
            {% endif %}
            {% if thread.resulting_essay_slug %}
            <span class="font-mono text-[10px] tracking-wide text-terracotta">
                Resulting essay
            </span>
            {% endif %}
        </div>
    </a>
    {% empty %}
    <div class="col-span-full flex flex-col items-center gap-3 py-12 text-center">
        <p class="font-title text-lg text-ink m-0">No threads found</p>
        <p class="font-mono text-[12px] tracking-wide text-ink-muted max-w-sm m-0">
            {% if active_filter %}
                No {{ active_filter }} threads at the moment.
            {% else %}
                Research threads will appear here once they are published.
            {% endif %}
        </p>
    </div>
    {% endfor %}
</div>
{% endblock %}
